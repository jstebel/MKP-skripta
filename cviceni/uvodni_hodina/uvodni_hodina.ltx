    % typesetting TODO
%
% - bibliography
% - METAFONT def of := ... \eqdef
% - tecky nad bold symbol se spatne umistuji
%
% conventions:
% crossrefs - typechap:name (type: [s]ection,[e]quation,[d]efinition,[t]heorem(lemma,..))
%                           (chap: [p]hysical background, [m]ath tools, [f]luid, [b]odies, [s]teady)
\documentclass[a4paper]{article}
% ***************************************** PACKAGES
\usepackage[utf8]{inputenc}
\usepackage[czech]{babel}

%\usepackage[active]{srcltx}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsthm}
\usepackage{fancyhdr}

\usepackage{graphicx}
\usepackage{xcolor}
\usepackage{gensymb}

\usepackage{array, makecell, booktabs}
\usepackage{arydshln}

\usepackage{hyperref}

%\usepackage{mathbbol}
%\usepackage{bbm}
% ***************************************** THEOREMS
%\newtheorem{thm}{Theorem}[section]
%\newtheorem{proposition}[thm]{Proposition}
%\newtheorem{definition}[thm]{Definition}
%\newtheorem{remark}[thm]{Remark}
%\newtheorem{corollary}[thm]{Corollary}
%\numberwithin{equation}{section}

\newtheorem{veta}{Věta}[section]
\newtheorem{theorem}[veta]{Věta}
\newtheorem{lemma}[veta]{Lemma}
\newtheorem{df}[veta]{Definice}
\newtheorem{ex}[veta]{Příklad}
\numberwithin{equation}{section}


% ***************************************** SYMBOLS
\def\div{\operatorname{div}}
\def\rot{\operatorname{rot}}
\def\Lapl{\Delta}
\def\grad{\nabla}
\def\rrot{\nabla\times}
\def\supp{{\rm supp}}
\def\dist{{\rm dist}}
%\def\chset{\mathbbm{1}}
\def\chset{1}

\def\Tr{{\rm Tr}}
\def\sgn{{\rm sgn}}
\def\to{\rightarrow}
\def\weakto{\rightharpoonup}
\def\imbed{\hookrightarrow}
\def\cimbed{\subset\subset}
\def\range{{\mathcal R}}
\def\leprox{\lesssim}
\def\argdot{{\hspace{0.18em}\cdot\hspace{0.18em}}}
\def\Distr{{\mathcal D}}
\def\calK{{\mathcal K}}
\def\FromTo{|\rightarrow}
\def\convol{\star}
\def\impl{\Rightarrow}
\DeclareMathOperator*{\esslim}{esslim}
\DeclareMathOperator*{\esssup}{ess\,sup}
\DeclareMathOperator{\ess}{ess}
\DeclareMathOperator{\osc}{osc}
\DeclareMathOperator{\curl}{curl}

%\def\Ess{{\rm ess}}
%\def\Exp{{\rm exp}}
%\def\Implies{\Longrightarrow}
%\def\Equiv{\Longleftrightarrow}
% ****************************************** GENERAL MATH NOTATION
\def\R{{\rm\bf R}}
\def\Real{{\rm\bf R}}
\def\Rd{{{\rm\bf R}^{\rm 3}}}
\def\RN{{{\rm\bf R}^N}}
\def\D{{\mathbb D}}
\def\Nnum{{\mathbb N}}
\def\Measures{{\mathcal M}}
\def\d{\,{\rm d}}               % differential
\def\sdodt{\genfrac{}{}{}{1}{\rm d}{{\rm d}t}}
\def\dodt{\genfrac{}{}{}{}{\rm d}{{\rm d}t}}

\def\vc#1{\mathbf{\boldsymbol{#1}}}     % vector
\def\tn#1{{\mathbb{#1}}}    % tensor
\def\abs#1{\lvert#1\rvert}
\def\Abs#1{\bigl\lvert#1\bigr\rvert}
\def\bigabs#1{\bigl\lvert#1\bigr\rvert}
\def\Bigabs#1{\Big\lvert#1\Big\rvert}
\def\ABS#1{\left\lvert#1\right\rvert}
\def\norm#1{\bigl\Vert#1\bigr\Vert} %norm
\def\close#1{\overline{#1}}
\def\inter#1{#1^\circ}
\def\ol#1{\overline{#1}}
\def\ul#1{\underline{#1}}
\def\eqdef{\mathrel{\mathop:}=}     % defining equivalence
\def\where{\,|\,}                    % "where" separator in set's defs
\def\timeD#1{\dot{\overline{{#1}}}}

% ******************************************* USEFULL MACROS
\def\RomanEnum{\renewcommand{\labelenumi}{\rm (\roman{enumi})}}   % enumerate by roman numbers
\def\rf#1{(\ref{#1})}                                             % ref. shortcut
\def\prtl{\partial}                                        % partial deriv.
\def\Names#1{{\scshape #1}}
\def\rem#1{{\parskip=0cm\par!! {\sl\small #1} !!}}

\def\Xint#1{\mathchoice
{\XXint\displaystyle\textstyle{#1}}%
{\XXint\textstyle\scriptstyle{#1}}%
{\XXint\scriptstyle\scriptscriptstyle{#1}}%
{\XXint\scriptscriptstyle\scriptscriptstyle{#1}}%
\!\int}
\def\XXint#1#2#3{{\setbox0=\hbox{$#1{#2#3}{\int}$}
\vcenter{\hbox{$#2#3$}}\kern-.5\wd0}}
\def\ddashint{\Xint=}
\def\dashint{\Xint-}

% ******************************************* DOCUMENT NOTATIONS
% document specific
\def\rh{\varrho}
\def\vl{{\vc{u}}}
\def\th{\vartheta}
\def\vx{\vc{x}}
\def\vX{\vc{X}}
\def\vr{\vc{r}}
\def\veta{\vc{\eta}}
\def\dx{\,\d\vx}
\def\dt{\,\d t}
\def\bulk{\zeta}
\def\cS{\close{S}}
\def\eps{\varepsilon}
\def\phi{\varphi}
\def\Bog{{\mathcal B}}
\def\Riesz{{\mathcal R}}
\def\distr{\mathcal D}
\def\Item{$\bullet$}

\def\MEtst{\mathcal T}
%***************************************************************************
\def\vrb#1{\verb"#1"}

\def\prednaska{\pagebreak \item přednáška \hrule}
\def\cviceni{\pagebreak \item cvičení \hrule}
\def\priklady{{\bf Další vhodné příklady:}}


% ************************************ NOTATIONS JS
\newcommand{\mat}[1]{\mathbb{#1}}
\newcommand{\Vc}{\mathcal V}
% *************************************************



\addtolength{\textwidth}{5cm}
\addtolength{\hoffset}{-2.5cm}
\addtolength{\textheight}{4cm}
\addtolength{\voffset}{-3cm}
%\addtolength{\oddsidemargin}{1cm}
%\addtolength{\evensidemargin}{-1cm}
\begin{document}
\parindent=0pt
\parskip=0.3cm
\begin{center}
{\LARGE\textbf{ MKP - Metoda konečných prvků}}

\vspace{0.5cm}
{\Large naposledy upraveno: \today}
\end{center}

% \pagebreak


\vspace{1cm}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Úvodní hodina a opakování}
\subsection{Laplaceova/Poissonova rovnice a fyzikální procesy}
\vspace{0.5cm}

Poissonova rovnice
\begin{align*}
    \textrm{v 1D:} & &  \varphi''& = f\\
    \textrm{v 2D, 3D:} & & \textcolor{gray}{\div (\grad \varphi) = }\Delta \varphi& = f
\end{align*}
(nebo Laplaceova pro $f=0$) je eliptická parciální diferenciální rovnice s velmi širokým užitím při popisu fyzikálních procesů. 
Několik důležitých příkladů je shrnuto v tabulce \ref{tab:processes}.
Ve všech případech je definována nějaká potenciální veličina (tlak, teplota, napětí, $\ldots$) a od ní odvozené vektorové pole
prostřednictvím záporně vzatého gradientu (např. voda vždy teče z místa s vyšším tlakem do místa nižšího tlaku, teplo se předává od teplejšího tělesa chladnějšímu apod.,
tedy vždy proti směru gradientu).

\begin{table}[thb]
% \centering\renewcommand\cellalign{lc}
% \setcellgapes{3pt}\makegapedcells
% \begin{tabular}{c|c|c|c|c}
\begin{tabular}{*{5}{>{\centering\arraybackslash}m{0.18\textwidth}<{}}} \toprule
Vedení tepla & Porézní proudění& Mechanika & Elektrostatika & Difúzní transport \\ [10pt] \hline
Fourierův zákon & Darcyho zákon & Hookův zákon & Elektrický potenciál & Fickův zákon \\[10pt] %\hline
$q=-\lambda T'$ & $q=-K p'$ & $\sigma=-E u'$ & $E=-\varphi'$, $D=\eps E$ & $q=-D c'$ \\[10pt] %\hline
$-(\lambda T')'=f$ & $-(K p')'=f$ & $-(E u')'=f$ & $-(\eps \varphi')'=f$ & $-(D c')'=f$ \\[10pt]
$q$ - tepelný tok & $q$ - Darcyho rychlost  & $\sigma$ - napětí & $E$ - elektrické pole & $q$ - difúzní tok\\
\makecell{$\lambda$ - tepelná\\ vodivost} & \makecell{$K$ - hydraulická\\ vodivost}  & \makecell{$E$ - Youngův\\ modul pružnosti} & $\eps$ - permitivita & $D$ - difuzivita\\ %\hline
$T$ - teplota & $p$ - tlak  & $u$ - posunutí & $\varphi$ - elektrický potenciál & $c$ - koncentrace\\ [10 pt] \hline
\multicolumn{5}{>{\centering\arraybackslash}m{\textwidth}<{}}{}\\
\multicolumn{5}{>{\centering\arraybackslash}m{\textwidth}<{}}{ve 2D:}\\ [10 pt]
$-\div(\grad T)=f$ & $-\div(K \grad p)=f$ & $-\div(E \grad u)=f$ & $-\div(\eps \grad\varphi)=f$ & $-\div(D \grad c)=f$ \\
\multicolumn{5}{>{\centering\arraybackslash}m{\textwidth}<{}}{}\\
\bottomrule
\end{tabular}
\caption{Tabulka fyzikálních procesů popsaných Poissonovou rovnicí.}
\label{tab:processes}
\end{table}

S takovými eliptickými rovnicemi budeme pracovat celý semestr, proto se s nimi dobře seznamte.
Budeme je řešit metodou konečných prvků, budeme se zabývat jejich řešitelností a prakticky implementovat numerické řešení.

\pagebreak

\subsection{Úkoly (opakování diferenciálních operátorů):}
Zopakujte si diferenciální operátory, které se hojně vyskytují v parc. diff. rovnicích.
Zvykněte si pracovat jak s derivacemi v 1D, tak s gradienty či divergencemi ve 2D a 3D.
\begin{itemize}
    \item $\Lapl(uv)=?\quad u,v\in C^2(\R)$
    \item $\vc r=(x,y)$, $r=\abs{\vc r}=\sqrt{x^2+y^2}$, určete: $\grad r$, $\Lapl r$
    \item $\vc r=(x,y,z)$, $r=\abs{\vc r}=\sqrt{x^2+y^2+z^2}$, určete: $\rrot \vc r$, $\div(\rrot \vc r)$
    \item Ukažte, že potenciální pole s potenciálem $\omega$ má nulovou rotaci, tedy že $\rrot (\grad \omega)=0$.
    \item Na kvádru $x\in[0,1],\;y\in[0,3],\;z\in[0,2]$ spočítejte
        \[ \int_S \vc F\cdot \vc n \d s, \qquad \vc F = (3x+z^{77}, y^2 - \sin x^2z, xz+ye^{x^5}).\]
\end{itemize}

\subsection{Úkoly (opakování MATLAB):}
Tipy k procvičení základů MATLABu:
\begin{itemize}
    \item Naimplementujte maticové násobení $\mat C^{m\times p}=\mat A^{m\times n}\mat B^{n\times p}$ ve složkovém tvaru: $c_{ij}=\sum\limits_{k=1}^n a_{ik}b_{kj}$.
    \item Napište funkci generující matici $m\times m$ tohoto tvaru (můžete použít funkci \verb'diag'):
    \[\begin{pmatrix}
    m & m-1 & m-2 & m-3 &\ldots & 1\\
    m-1 & m & m-1 & m-2 &\ldots & 2\\
    m-2 & m-1 & m & m-1 &\ldots & 3\\
    m-3 & m-2 & m-1 & m & \ldots & 4\\
    \vdots & \vdots & \vdots & \vdots & \ddots & \vdots\\
    1 & 2 & 3 & 4 &\ldots  & m\\
    \end{pmatrix}.\]
    \item Vygenerujte náhodnou matici $m\times m$, $m>10$ a nalezněte její největší prvek (pozici i hodnotu).\\
        Proveďte nejprve pomocí \verb'for' cyklu, poté pomocí funkce \verb'max'.
\end{itemize}

\subsection{Seznámení s Code Critic}
Zkuste se dále přihlásit do systému \href{http://alva.nti.tul.cz:5000/courses/MKP/2020}{Code Critic} a vyzkoušejte jednoduché testovací úlohy, označené jako \verb'trial_*'. Při případných problémech nám prosím dejte ihned zpětnou vazbu.

Nakonec se pokuste naimplementovat Gaussovu eliminaci s řádkovou pivotací a odevzdat přes \href{http://alva.nti.tul.cz:5000/courses/MKP/2020/cv\_1\_1}{Code Critic} jako úlohu \verb'CV_1'.

\end{document}

