    % typesetting TODO
%
% - bibliography
% - METAFONT def of := ... \eqdef
% - tecky nad bold symbol se spatne umistuji
%
% conventions:
% crossrefs - typechap:name (type: [s]ection,[e]quation,[d]efinition,[t]heorem(lemma,..))
%                           (chap: [p]hysical background, [m]ath tools, [f]luid, [b]odies, [s]teady)
\documentclass[a4paper]{article}
% ***************************************** PACKAGES
%\usepackage[active]{srcltx}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsthm}
\usepackage{fancyhdr}
\usepackage{hyperref}
\usepackage[utf8]{inputenc}
\usepackage[czech]{babel}
%\usepackage{mathbbol}
%\usepackage{bbm}
% ***************************************** THEOREMS
%\newtheorem{thm}{Theorem}[section]
%\newtheorem{proposition}[thm]{Proposition}
%\newtheorem{definition}[thm]{Definition}
%\newtheorem{remark}[thm]{Remark}
%\newtheorem{corollary}[thm]{Corollary}
%\numberwithin{equation}{section}

\newtheorem{veta}{Věta}[section]
\newtheorem{theorem}[veta]{Věta}
\newtheorem{lemma}[veta]{Lemma}
\newtheorem{df}[veta]{Definice}
\newtheorem{ex}[veta]{Příklad}
\numberwithin{equation}{section}


% ***************************************** SYMBOLS
\def\div{\operatorname{div}}
\def\rot{\operatorname{rot}}
\def\Lapl{\Delta}
\def\grad{\nabla}
\def\supp{{\rm supp}}
\def\dist{{\rm dist}}
%\def\chset{\mathbbm{1}}
\def\chset{1}

\def\Tr{{\rm Tr}}
\def\sgn{{\rm sgn}}
\def\to{\rightarrow}
\def\weakto{\rightharpoonup}
\def\imbed{\hookrightarrow}
\def\cimbed{\subset\subset}
\def\range{{\mathcal R}}
\def\leprox{\lesssim}
\def\argdot{{\hspace{0.18em}\cdot\hspace{0.18em}}}
\def\Distr{{\mathcal D}}
\def\calK{{\mathcal K}}
\def\FromTo{|\rightarrow}
\def\convol{\star}
\def\impl{\Rightarrow}
\DeclareMathOperator*{\esslim}{esslim}
\DeclareMathOperator*{\esssup}{ess\,sup}
\DeclareMathOperator{\ess}{ess}
\DeclareMathOperator{\osc}{osc}
\DeclareMathOperator{\curl}{curl}

%\def\Ess{{\rm ess}}
%\def\Exp{{\rm exp}}
%\def\Implies{\Longrightarrow}
%\def\Equiv{\Longleftrightarrow}
% ****************************************** GENERAL MATH NOTATION
\def\R{{\rm\bf R}}
\def\Real{{\rm\bf R}}
\def\Rd{{{\rm\bf R}^{\rm 3}}}
\def\RN{{{\rm\bf R}^N}}
\def\D{{\mathbb D}}
\def\Nnum{{\mathbb N}}
\def\Measures{{\mathcal M}}
\def\d{\,{\rm d}}               % differential
\def\sdodt{\genfrac{}{}{}{1}{\rm d}{{\rm d}t}}
\def\dodt{\genfrac{}{}{}{}{\rm d}{{\rm d}t}}

\def\vc#1{\mathbf{\boldsymbol{#1}}}     % vector
\def\tn#1{{\mathbb{#1}}}    % tensor
\def\abs#1{\lvert#1\rvert}
\def\Abs#1{\bigl\lvert#1\bigr\rvert}
\def\bigabs#1{\bigl\lvert#1\bigr\rvert}
\def\Bigabs#1{\Big\lvert#1\Big\rvert}
\def\ABS#1{\left\lvert#1\right\rvert}
\def\norm#1{\bigl\Vert#1\bigr\Vert} %norm
\def\close#1{\overline{#1}}
\def\inter#1{#1^\circ}
\def\ol#1{\overline{#1}}
\def\ul#1{\underline{#1}}
\def\eqdef{\mathrel{\mathop:}=}     % defining equivalence
\def\where{\,|\,}                    % "where" separator in set's defs
\def\timeD#1{\dot{\overline{{#1}}}}

% ******************************************* USEFULL MACROS
\def\RomanEnum{\renewcommand{\labelenumi}{\rm (\roman{enumi})}}   % enumerate by roman numbers
\def\rf#1{(\ref{#1})}                                             % ref. shortcut
\def\prtl{\partial}                                        % partial deriv.
\def\Names#1{{\scshape #1}}
\def\rem#1{{\parskip=0cm\par!! {\sl\small #1} !!}}

\def\Xint#1{\mathchoice
{\XXint\displaystyle\textstyle{#1}}%
{\XXint\textstyle\scriptstyle{#1}}%
{\XXint\scriptstyle\scriptscriptstyle{#1}}%
{\XXint\scriptscriptstyle\scriptscriptstyle{#1}}%
\!\int}
\def\XXint#1#2#3{{\setbox0=\hbox{$#1{#2#3}{\int}$}
\vcenter{\hbox{$#2#3$}}\kern-.5\wd0}}
\def\ddashint{\Xint=}
\def\dashint{\Xint-}

% ******************************************* DOCUMENT NOTATIONS
% document specific
\def\rh{\varrho}
\def\vl{{\vc{u}}}
\def\th{\vartheta}
\def\vx{\vc{x}}
\def\vX{\vc{X}}
\def\vr{\vc{r}}
\def\veta{\vc{\eta}}
\def\dx{\,\d\vx}
\def\dt{\,\d t}
\def\bulk{\zeta}
\def\cS{\close{S}}
\def\eps{\varepsilon}
\def\phi{\varphi}
\def\Bog{{\mathcal B}}
\def\Riesz{{\mathcal R}}
\def\distr{\mathcal D}
\def\Item{$\bullet$}

\def\MEtst{\mathcal T}
%***************************************************************************
\def\vrb#1{\verb"#1"}

\def\prednaska{\pagebreak \item přednáška \hrule}
\def\cviceni{\pagebreak \item cvičení \hrule}
\def\priklady{{\bf Další vhodné příklady:}}


% ************************************ NOTATIONS JS
\newcommand{\mat}[1]{\mathbb{#1}}
\newcommand{\Vc}{\mathcal V}
% *************************************************



\addtolength{\textwidth}{5cm}
\addtolength{\hoffset}{-2.5cm}
\addtolength{\textheight}{4cm}
\addtolength{\voffset}{-3cm}
%\addtolength{\oddsidemargin}{1cm}
%\addtolength{\evensidemargin}{-1cm}
\begin{document}
\parindent=0pt
\parskip=0.3cm
\begin{center}
{\LARGE MKP - Metoda konečných prvků, cvičení}
\end{center}

\pagebreak
\section{Opakování}
{\bf Témata:} Vektorový prostor, lineární zobrazení, matice, inverzní matice, hodnost, soustava lin. rovnic, vlastní čísla a vektory.
Vektorový prostor funkcí. Skalární a vektorové funkce více promenných. Derivace složených funkcí.
Diferenciální operátory: gradient, divergence, rotace. 

{\bf Příklady k řešení:}
\begin{enumerate}
  \item Vektorový prostor funkcí.
  \item Tvoří množina $\{t^2+1, (t+1)^2, (t-1)^2\}$ bázi prostoru $P_2$? Jakou hodnost má příslušná matice? 
  \item Najděte matici přechodu z  báze $a:(3\sin(t+\alpha), 2\cos(t+\alpha))$ do báze $b:(\sin(t), \cos(t))$ a její inverzní matici.
  Najděte matici přechodu z báze $b$ do báze $a$. Matice $X_a$ bilineární formy $X(\vc u, \vc v)$ v bázi $A$ je $[1\ 0;0\ -1]$ 
  nalezněte její matici $X_b$ v bázi $b$. Jaká budou vlastní čísla a vlastní vektory matice $X_b$?
  \item 
Nechť $f(x,y,z)$, $g(x,y,z)$ jsou dané funkce tří proměnných. Transformujte výraz:
\[
  V=\frac{\prtl f}{\prtl x} \frac{\prtl g}{\prtl y} - \frac{\prtl g}{\prtl x} \frac{\prtl f}{\prtl y}
    +\frac{\prtl f}{\prtl z} \frac{\prtl g}{\prtl z}
\]
do "cylindrických" souřadnic:
\[
   x=r \cos \phi,\quad y=r\sin \phi,\quad h=2z+1.
\]

výsledek: 
\[
  \frac{1}{r}\Big(\frac{\prtl f}{\prtl r} \frac{\prtl g}{\prtl \phi}
        -\frac{\prtl f}{\prtl \phi} \frac{\prtl g}{\prtl r}\Big)
        +4\frac{\prtl f}{\prtl h}\frac{\prtl g}{\prtl h}
\]
 \item Je dáno:
 \[
    \prtl_a u = b^2,\ \prtl_b u = 2ab,\ a(x) = 1+x^2,\ b(y)=y^2  
 \]
 Vypočtěne Jacobiho matici funkce $\vc f(x,y) = [u, -2u+y, u^2]$
\item Pro polohový vektor (rádius vektor)
\[
   \vc r =(x,y,z),\quad r=\abs{\vc r}=\sqrt{r_1^2+ r_2^2 + r_3^2}.
\]
spočtěte:
\[
 \text{a) } \nabla \cdot \vc r\qquad
 \text{b) } \nabla \times \vc r\qquad
 \text{c) } \nabla \cdot \frac{\vc r}{r^3}\qquad
 \text{d) } \nabla \times \frac{\vc r}{r^3}\qquad
\]
Plyne z posledních dvou výsledků porušení Helmholtzovy dekompozice?
\item Spočtěte $\div(\rot(\vc \omega))$ pro obecné vektorové pole $\omega$.
\end{enumerate}

{\bf Příklady doplňující}
\begin{enumerate}
\item Derivace složené funkce - \cite{CVUT} str. 29; 1,2,3,4 
\item První derivace, 2 nezávisle proměnné - \cite{CVUT} str. 50; 2,3
\item Polarní souřadnice - \cite{CVUT} str. 52; 8, 10*
\item Diferenciální operátory, vektorový počet: \cite{CVUT} str. 221,
\item Gradient - \cite{CVUT} str. 223; 1-4,6,8*,13,17a,
\item Divergence - \cite{CVUT} str. 232; 25, 27, 28-36
\item Rotace - \cite{CVUT} str. 237;  38-42 
\end{enumerate}




\pagebreak
\section{Integrace po křivce a po ploše. Stokesova, Greenova, Gaussova věta.}
\textit{Křivkový integrál 1. druhu} ze skalárního pole $f$ podél křivky $k$ dané parametricky funkcí $\vc \phi(t),\ t\in[\alpha,\beta]$ (\cite{CVUT} str. 135):
\[
   \int_k f \d k = \int_{\alpha}^\beta f\big(\vc \phi(t)\big)\, \abs{\vc \phi'(t)} \dt=
   \int_\alpha^\beta f(\phi_x,\phi_y,\phi_z) \sqrt{ (\phi_x')^2+(\phi_y')^2+(\phi_z')^2} \dt.
\]
% kde $\vc \phi'(t)$ je tečný vektor, tj. vektor derivace funkce $\phi$, .

\textit{Křivkový integrál 2. druhu} z vektorového pole $\vc F$ (práce pole podél křivky, \cite{CVUT} str. 169):
\[
 \int_k \vc F \cdot \vc t \d k = \int_\alpha^\beta \vc F( \vc \phi(s) ) \cdot \vc \phi'(s) \d s.
\]

\textit{Plošný integrál 1. druhu} ze skalárního pole $f$ podél plochy $S$ dané parametricky funkcí
$\vc \phi(u,v), [u,v]\in M\subset \Real^2$ (\cite{CVUT} str. 151):
\[
   \int_S f \d S = \int_M f(\vc \phi(u,v)) \abs{\vc N(u,v)} \d u\d v=
   \int_M f(\phi_x,\phi_y,\phi_z) \sqrt{ (N_x)^2 + (N_y)^2 + (N_z)^2} \d u\d v,
\]
kde $\vc N$ je normála plochy (vektor kolmý k ploše jehož velikost je daná "velikostí elementární plošky"). Normála je rovna vektorovému součinu tečných vektorů:
\[
   \vc N= \vc t_u \times \vc t_v,\quad \vc t_u = \frac{\prtl \vc \phi}{\prtl u},\quad \vc t_v=\frac{\prtl \vc \phi}{\prtl v}.
\]
Pozor, pokud plocha není rovina, tak normála a tudíž i její velikost závisí na parametrech $u, v$.

\textit{Plošný integrál 2. druhu} z vektorového pole $\vc F$ (celkový tok pole skrz plochu, \cite{CVUT} str. 192):
\[
  \int_S \vc F\cdot \vc n\d S = \int_M \vc F( \vc \phi(u,v) ) \cdot \big( \prtl_u \vc \phi \times \prtl_v \vc \phi\big) \d u\d v.
\]

\begin{tabular}{|l|l|l|}
\hline
Veličina & Křivka & Plocha\\
\hline
Délka/plocha & $\displaystyle L=\int_k\d k$ & $\displaystyle P = \int_S\d S$\\&&\\
Hmotnost & $\displaystyle M = \int_k\rho\d k$ & $\displaystyle M = \int_S\rho\d S$\\&&\\
Poloha těžiště& $\displaystyle\vc T=\frac1M\int_k\vc x\rho\d k$ & $\displaystyle\vc T=\frac1M\int_S\vc x\rho\d S$\\&&\\
Moment setrvačnosti& $\displaystyle I_z = \frac1M\int_k(x_x^2+x_y^2)\rho\d k$ & $\displaystyle I_z=\frac1M\int_S(x_x^2+x_y^2)\rho\d S$\\
\hline
\end{tabular}

\bigskip

\underline{Stokesova věta}: Pro plochu $S$ ohraničenou uzavřenou křivkou $k$ platí:
\[
        \int_S (\rot \vc F) \cdot \vc n \d S = \int_k \vc F\cdot \vc t \d k.
\]
\underline{Gaussova věta}: Pro objem $V$ ohraničený plochou $S$ platí:
\[
        \int_V \div \vc F \d V = \int_S \vc F\cdot \vc n \d S.
\]

\underline{Greenova věta} (integrace per partes): Pro objem $V$ ohraničený plochou $S$ platí:
\[
        \int_V  \prtl_x u  v \d V = \int_S u v n_x \d S - \int_V u \prtl_x v \d V
\]
\[
        \int_V (\grad u) \cdot \vc v \d V = \int_S u \vc v \cdot \vc n \d S - \int_V u \div \vc v \d V
\]

\newpage

{\bf Příklady k řešení:}
\begin{enumerate}
    \item Šroubovice má poloměr $r$ a výšku závitu $h$. Spočtěte délku jejího závitu, polohu těžiště a moment setrvačnosti vzhledem k ose šroubovice.
    
    [$L=\sqrt{(2\pi r)^2+h^2}$, $\vc T=(0,0,h/2)$, $I=r^2$]
    
    \item Spočtěte hmotnost a polohu těžiště polosféry 
    \[ x^2+y^2+z^2=a^2, \quad z\ge 0, \]
    jejíž hustota je $\rho(x,y,z)=\frac za$.
    
    [$\pi a^2$, $(0,0,\frac23a)$]
    
    
    
    \item Spočítejte tok vektorového pole
        \[
                \vc F=(x+y^3,y+z^3,z+x^3) 
        \]
        plochou danou rovnicí
        \[
                x^2+y^2+z^2=x.
        \]
        {\it Návod: }Použijte Gaussovu větu a  substituci do sférických souřadnic. $[\pi/2]$
     
     \item Pomocí Stokesovy věty vypočtěte integrál
     \[ \int_k (y+z,z+x,x+y)\cdot\vc t \d k, \]
     kde $k$ je elipsa $x=a\sin^2 t$, $y=2a\sin t\cos t$, $z=a\cos^2 t$, $0\le t\le \pi$, orientovaná ve směru rostoucího parametru t. [$0$]
     
     \item Ukažte, že pravidlo "per partes" je speciální případ Greenovy věty.
     
     \item Nechť plocha $S$ ohraničuje objem $V$. Pomocí Gaussovy věty dokažte, že pro hladké vektorové pole $\vc u$ platí:
     \[ \int_S(\rot\vc u)\cdot\vc n \d S = 0. \]
     
     \item Nechť $u$ je řešením okrajové úlohy
     \[ -\div(\mat A\nabla u) = f \mbox{ ve }V,\quad (\mat A\nabla u)\cdot\vc n = g \mbox{ na }S, \]
     kde plocha $S$ ohraničuje objem $V$ a $\mat A,f,g$ jsou zadané funkce.
     Pomocí Greenovy věty ukažte, že pro libovolnou hladkou funkci $v$ platí rovnost:
     \[ \int_V \mat A\nabla u\cdot\nabla v \d V= \int_S g v \d S + \int_V f v \d V. \]
     
       
%     \item
%         Spočítejte tok pole $\vc F=(y,x,-z)$ trojúhelníkem $A=(1,0,0)$, $B=(0,2,0)$, $C=(0,0,3)$ orientovaným 
%         směrem od počátku. [3/2]
%     \item    
%     \item
%     Spočítejte moment setrvačnosti kuželolvé plochy $x^2+y^2-4z^2=0$, $0<z<\frac12$ s hustotou $\rho(x,y,z)=z$ vzhledem k přímce $\{y=0,\ z=\frac12\}$.
%     Návod: Použijte cylindrické souřadnice pro parametrické vyjádření plochy. $[\pi\sqrt{5}13/(20*12)]$
% 
%     \item
%     Spočítejte práci elastické síly směřující do počátku o velikosti dvojnásobku vzdálenosti do počátku
%     podél šroubovice $\{3\cos 2t, 3 \sin 2t, t\}$, $0<t<2\pi$. Vysvětlete proč je výsledek záporný.
%     $[-4\pi^2]$

\end{enumerate}


{\bf Příklady doplňující:}
\begin{enumerate}
\item Fubiniho věta: \cite{CVUT} str. 89 (př: 1-7,9,11)
\item Substituce:  \cite{CVUT} str. 97 (př: 1-3, 7)
\item Aplikace integrálů: \cite{CVUT} str. 112-134
\item Křivkové integrály: \cite{CVUT} str. 135-150; str. 169-191
\item Plošné integrály: \cite{CVUT} str. 150-168; str. 192-196;
 str. 248; 199/12 (hmotnost), 249/58 (hmotnost), 122/20\dots (3D momenty), 159/11 (skořepina), 
\item Greenova věta: \cite{CVUT} str. 197-207; 
\item Gaussova, Stokesova věta: \cite{CVUT} str. 208-220; 244/48, 245/51, 246/52, 247/54
\end{enumerate}
\pagebreak

\section{Matematické modely. Klasifikace PDR, vlastnosti řešení.}
\subsection{Rovnice kmitů struny}
Odvoďte rovnici pro rovinné kmity struny. Výchylka struny v čase $t$ a bodě $x$ v intervalu $(0,1)$ je dána funkcí $u(t,x)$.
\begin{enumerate}
    \item Načrtněte si element struny mezi body $a$, $b$. Jakými silami působí okolí struny na tento element. Vypočtěte při znalosti výchylky $u(t,\argdot)$
    horizontální a vertikální sílu působící na element.
    \item Použijte druhý Newtonův zákon pro změnu hybnosti elementu (integrál 1. druhu) v horizontalním a vertikálním směru. 
          Odvoďte "integrální formulaci" pro výchylku $u$.
    \item Odvoďte bodovou formulaci rovnice. pro výchylku $u$.
\end{enumerate}

\subsection{Chování parabolických a hyperbolických rovnic}
Na stránce \url{http://math.uchicago.edu/~luis/pde/} pozorujte chování vlnové rovnice a rovnice vedení tepla. 
Vždy nejprve odhadněte jak se řešení bude chovat a pak teprve spusťte simulaci.
\begin{enumerate}
    \item Pro řešič vlnové rovnice. Spusťte simulaci pro výchozí nastavení. Počáteční podmínka se skládá z výchylku $u$ a její časové derivace $\prtl_t u$.
    \item Upravte $\prtl_t u(0,\cdot)$ tak aby vlna na počátku směřovala doprava.
    \item Co se stane, když nezadáte rychlost? Jaké reálné situaci to odpovídá?
    \item Demonstrujte, že neplatí princip maxima.
    \item Pokuste se fyzikálně interpretovat Dirichletovu a Neumannovu okrajovou podmínku.
\end{enumerate}

\begin{enumerate}
    \item Pro řešič rovnice vedení tepla. Spusťte simulaci pro výchozí nastavení. Počáteční podmínka je pouze počáteční teplota v každém bodě $u(0,x)$.
    \item Nastavte Neumannovu OKP (odpovídá tepelné izolaci). Nastavte na jedné straně skok z 1 na 0. Teplo jen na jedné straně. Co očekáváte?
    \item Nastavte poč. podmínku s množstvím různých skoků? Co očekáváte?    
    \item Pozorujte zachování principu maxima v různých případech.
    \item Jaká je interpretace Dirichletovy okrajové podmínky.
\end{enumerate}

\subsection{Fourierova metoda pro rovnici vedení tepla}
Řešte rovnici vedení tepla, na oblasti $\Omega = (0,1) \subset \Real$ a pro čas $t\ge 0$:
\begin{equation}
    \label{eq:heat_in_domain}
    \frac{\prtl u}{\prtl t}(t,y) = \frac{\prtl^2 u}{\prtl y^2}(t,y)
\end{equation}
okrajové podmínky 
\begin{equation}
    \label{eq:heat_bc}
    u(t,0) = u(t,1) = 0
\end{equation}
Počáteční podmínka:
\begin{equation}
    \label{eq:heat_ic}
    u(0,y) = y 
\end{equation}

\begin{enumerate}
\item Proveďte separaci proměnných. Hledejte všechna řešení ve tvaru $u(t,y)= T(t)Y(y)$. Dosaďte do \eqref{eq:heat_in_domain}, nalezněte řešení pro $T$ a $Y$.
\item Použijte okrajovou podmínku \eqref{eq:heat_bc}. Pro omezení konstanty $\lambda$ a tím prostoru řešení.
\item Použijte princip superpozice (platí pro lineární PDR).
\item Napište obecné řešení ve formě Fourierovy řady a použijte počáteční podmínku \eqref{eq:heat_ic}.
\item Určete koeficienty fourierovy řady $b_k = \frac{1}{\pi}\int_{-\pi}^{+\pi} f(y) \sin(ky)$.
Požijete \url{https://www.wolframalpha.com}.
\end{enumerate}



\subsection{Fourierova metoda pro vlnovou rovnici}
Řešte vlnovou rovnici, na oblasti $\Omega = (0,1) \subset \Real$ a pro čas $t\ge 0$:
\begin{equation}
    \label{eq:heat_in_domain}
    \frac{\prtl^2 u}{\prtl t^2}(t,y) = c^2\frac{\prtl^2 u}{\prtl y^2}(t,y)
\end{equation}
okrajové podmínky 
\begin{equation}
    \label{eq:heat_bc}
    u(t,0) = u(t,1) = 0
\end{equation}
Počáteční podmínky:
\begin{equation}
    \label{eq:heat_ic}
    u(0,y) = y,\ \prtl_t u(0,y)=0 
\end{equation}


\begin{enumerate}
\item Proveďte separaci proměnných. Hledejte řešení ve tvaru $u(t,y)= T(t)Y(y)$, dosaďte do \eqref{eq:heat_in_domain}, nalezněte řešení pro $T$ a $Y$.
\item Použijte okrajovou podmínku \eqref{eq:heat_bc}. Pro omezení počtu řešení na spočetně mnoho.
\item Napište obecné řešení ve formě Fourierovy řady a použijte počáteční podmínku \eqref{eq:heat_ic}.
\item Určete koeficienty Fourierovy řady.
\end{enumerate}


\subsection{Fourierova metoda pro Laplaceovu rovnici}
Řešte Laplaceovu rovnici, na oblasti $\Omega = (0,\pi)\times (0,\pi)$:
\begin{equation}
    \label{eq:heat_in_domain}
    \frac{\prtl^2 u}{\prtl x^2}(x,y) + \frac{\prtl^2 u}{\prtl y^2}(x,y) = f(x,y)
\end{equation}
okrajové podmínky 
\begin{equation}
    \label{eq:heat_bc}
    u(0,y) = u(1,y) = 0,\quad \prtl_y u(x,0)= \prtl_y u(x,1)= 0
\end{equation}








\pagebreak

\section{Slabé řešení a úvod do metody konečných prvků}

\subsection{Slabé řešení}
Nechť $f$ je zadaná spojitá funkce.
Okrajová úloha
\begin{equation}\label{eq:1d_bvp}
\begin{aligned}
-u''(x) &= f(x) &&\mbox{ pro }x\in(0,1), \\
u(0) &= u(1) = 0,
\end{aligned}
\end{equation}
je prototypem úlohy, popisující např. průhyb struny nebo vedení tepla.
V jedné prostorové dimenzi umíme úlohu na intervalu vyřešit analyticky, pokud rovnici dvakrát integrujeme.
Pro analogickou úlohu na obecné oblasti ve 2D nebo 3D však \emph{klasické} řešení najít neumíme, a proto místo něj hledáme řešení \emph{slabé}.
Při definici slabého řešení budeme používat množinu funkcí
\[ \Vc:=\{v\in C([0,1]);~v'\mbox{ je po částech spojitá},~v(0)=v(1)=0\} \]
a skalární součin
\[ (u,v) := \int_0^1 u(x)v(x)~\d x. \]
Ve slabé formulaci úlohy \eqref{eq:1d_bvp} hledáme funkci $u\in\Vc$, splňující
\begin{equation}\label{eq:1d_bvp_weak}\tag{V}
\forall v\in\Vc:~(u',v')=(f,v).
\end{equation}

\begin{enumerate}
\item Odvoďte vztah \eqref{eq:1d_bvp_weak}:
\begin{itemize}
\item Vynásobte \eqref{eq:1d_bvp}${}_1$ číslem $v(x)$, kde $v\in \Vc$.
\item Rovnici integrujte přes interval $(0,1)$ a levou stranu upravte pomocí integrace per partes.
\end{itemize}

\item Ukažte, že pokud slabé řešení $u\in\Vc$ má na intervalu $(0,1)$ spojitou 2. derivaci, pak je také klasickým řešením.

\item Ukažte, že formulace \eqref{eq:1d_bvp_weak} je ekvivalentní úloze minimalizace funkcionálu $F(u):=\frac12(u',u')-(f,u)$:
\begin{equation}\label{eq:1d_min}\tag{M}
\mbox{Najdi }u\in\Vc\mbox{ takové, že }\forall v\in\Vc:~F(u)\le F(v).
\end{equation}

\item Ukažte, že nemohou existovat dvě různá slabá řešení úlohy \eqref{eq:1d_bvp}.

\item Odvoďte slabou formulaci pro úlohu
\[ -u''(x)+u(x) = f(x) \mbox{ pro }x\in(0,1),  \quad u'(0)=u'(1)=0. \]

\item* Odvoďte slabou formulaci pro úlohu 4. řádu
\[ u^{(4)}(x) = f(x) \mbox{ pro }x\in(0,1),  \quad  u(0)=u'(0)=u(1)=u'(1)=0, \]
která popisuje průhyb nosníku.

\item* Odvoďte slabou formulaci pro úlohu 
     \[ -\div(\mat A\nabla u) = f \mbox{ ve }V,\quad (\mat A\nabla u)\cdot\vc n = g \mbox{ na }S, \]
     kde plocha $S$ ohraničuje objem $V$ a $\mat A,f,g$ jsou zadané funkce.

\end{enumerate}


\subsection{Metoda konečných prvků}

Nyní zavedeme podprostor $\Vc_h\subset\Vc$ s konečnou dimenzí, tvořený po částech lineárními funkcemi.
\begin{itemize}
\item Rozdělíme interval $(0,1)$ pomocí bodů $0=x_0<x_1<x_2<...<x_M<x_{M+1}=1$ na podintervaly $I_j=(x_{j-1},x_j)$.
Délku $I_j$ označíme $h_j:=x_j-x_{j-1}$ a definujeme $h:=\max h_j$.
\item Prostor $\Vc_h$ definujeme jako množinu všech spojitých funkcí $v$, které jsou na každém podintervalu $I_j$ lineární, a navíc $v(0)=v(1)=0$.
\item Bázi $\Vc_h$ definujeme jako funkce $\varphi_i\in\Vc_h$, určené podmínkami $\varphi_i(x_j)=\delta_{ij}$.
Libovolnou funkci $v\in\Vc_h$ pak můžeme zapsat ve tvaru
\[ v(x) = \sum_{j=1}^M\xi_j\varphi_j(x),~\xi_j=v(x_j). \]
Vektorový prostor $\Vc_h$ má tedy dimenzi $M$.
\end{itemize}
Metodu konečných prvků pro úlohu \eqref{eq:1d_bvp} nyní můžeme formulovat následovně:
\begin{equation}\label{eq:1d_galerkin}\tag{V${}_h$}
\mbox{Najdi }u_h\in\Vc_h \mbox{ takové, že }\forall v\in\Vc_h:~(u_h',v')=(f,v).
\end{equation}
Nebo alternativně:
\begin{equation}\label{eq:1d_ritz}\tag{M${}_h$}
\mbox{Najdi }u_h\in\Vc_h\mbox{ takové, že }\forall v\in\Vc_h:~F(u_h)\le F(v_h).
\end{equation}
První formulaci říkáme \emph{Galerkinova} metoda, druhé \emph{Ritzova} metoda.


\begin{enumerate}
\setcounter{enumi}{7}
\item Vypočítejte skalární součiny $(\varphi_i,\varphi_j)$, $i,j=1,...,M$.
\item Pro $u_h$ ve tvaru $u_h(x)=\sum_{j=1}^M\xi_j\varphi_j(x)$ formulujte úlohu \eqref{eq:1d_galerkin} jako soustavu lineárních rovnic pro $\vc\xi=(\xi_1,...,\xi_M)^\top$.
\item Určete matici soustavy z předchozího cvičení pro případ ekvidistantního dělění intervalu, tj. $h_j=h$.
Ukažte, že tato matice je symetrická a pozitivně definitní (tj. $\vc \eta\cdot\mat A\vc \eta>0$ pro každé $\vc \eta\in\Real^M\setminus\{\vc 0\}$).
\item Uvažujte prostor $\Vc_h$ tvořený spojitými funkcemi, které jsou na každém $i_j$ kvadratické.
Jak lze zvolit parametry popisující tyto funkce?
Najděte vhodnou bázi.
Formulujte metodu konečných prvků s tímto prostorem a pro ekvidistantní dělení intervalu odvoďte tvar matice soustavy.
\end{enumerate}

\pagebreak
\subsection{Slabé řešení, praktický problém}
Kolonavý experiment probíhá ve skleněném válci o průměru $R$, ve válci je do výšky $h_s$ hrubý štěrk (hydraulická vodivost $k_s$) a
nad ním je vrstva písku o mocnosti $h_p$ (hydraulická vodivost) $k_p$. Stěna válce okolo vrstvy písku je perforovaná a obalená membránou, 
na které byl při tlakovém rozdílu 1 Pa naměřen tok $5e-6 m^3/s$ na $m^2$ plochy. Na horní podstavě (na povrchu písku), je udržována hladina vody. 
Spodní podstava je preforovaná a je naměřen konstantní tok vody $1e-6 m^3/s$. Navrhněte výpočetní oblast, a rozdělení hranice podle druhů okrajových podmínek.
Sestavte rovnice popisující rozložení tlaku a rychlosti ve válci. Napište okrajové podmínky. Odvoďte slabou formulaci úlohy.


\pagebreak
\section{Normovaný lineární prostor}

\begin{enumerate}
\item Zjistěte, zda následující zobrazení jsou lineární, resp. bilineární formy:
\[ l_1(u) = \int_0^1 (u(x)+1)~dx,~u\in C([0,1]), \]
\[ l_2(u) = u(0) + \int_{\frac12}^1 u'(x)~dx,~u\in C^1([0,1]), \]
\[ l_3(u) = \int_0^1 u^2(x)~dx, ~u\in C([0,1]); \]
\[ a_1(u,v) = \int_0^1u(x)v'(x)~dx,~u,v\in C^1([0,1]), \]
\[ a_2(u,v) = \int_0^1 xu'(x)v'(x)~dx,~u,v\in C^1([0,1]). \]
Je některá z bilineárních forem skalárním součinem?

\item Ověřte, že $\norm{\ }_\infty$ je norma na $C(\overline\Omega)$.

\item Pomocí definice ukažte, že norma je nezáporná funkce.

\item Množiny v $\Real^2$ ...

\item Zjistěte, zda následující posloupnosti mají bodovou limitu a pokud ano, ověřte, zda konvergují v $\norm{\ }_2$ a $\norm{\ }_\infty$:
\[ u_n(x)=x^n \mbox{ na }[0,1],\qquad v_n(x)=x^2+x/n \mbox{ na }[-1,1],\quad w_n(x)=\begin{cases}n;&x\in[0,1/n^3]\\x^{-1/3};&x\in(1/n^3;1],\end{cases} \]
\[ z_n(x)=\sqrt{\cos(\frac xn)e^{-x}}\mbox{ na }[-1,1]. \]
\end{enumerate}


\pagebreak
\section{Lax-Milgramovo lemma, vlastnosti forem}
... viz. příklady z kapitoly 12 textů k přednášce.

% \subsubsection{Anizotropní difúze}
% Uvažujme úlohu vedení tepla ve čtvercové desce, která je z jedné strany zahřívána infračervenými lampami 
% tepelným tokem $f$ a z druhé strany předehřívána ocelovou matricí s tepelnou vodivostí $\sigma$, která je dále 
% vyhřívána soustavou kanálků s vodou o teplotě $u_f$. Na dvou stranách čtverce je tepelná izolace, na druhých dvou stranách je 
% kostantní teplota $u=0$ (toto je nereálné, ale je to jen příklad). Deska je kompozitní materiál složený z polymerové pryskyřice 
% (vodivost 1W/mK) a uhlíkových vláken (vodivost 1000W/mK) s preferovaným směrem, tepelná vodivost desky je proto anisotropní.
% 
% Formulujme nyní úlohu abstraktněji.
% 
% Mějme oblast $\Omega\subset\R^d$ (například čtverec $d=2$) s hranicí 
% $\partial\Omega=\overline\Gamma_d\cup\overline\Gamma_n$, tedy s Dirichletovskou a Neumannovskou částí hranice.
% Na této oblasti hledáme teplotu $u:\overline\Omega\to\R$, která je řešením stacionární rovnice vední tepla:
% \begin{align}
%     -\div(\tn K\grad u) &= f + \sigma(u_f - u) &&\text{v }\Omega,\\
%     u&=0 && \text{na }\Gamma_d,\\
%     -\tn K \grad u \cdot \vc n &= q &&\text{na }\Gamma_n.
% \end{align} 
% Zde $\tn K:\Omega\to\R^{d\times d}$ je maticová funkce pro tenzor tepelné vodivosti
% a $f$, $\sigma$, $u_f$ jsou skalární funkce na $\Omega$  a $q$ skalární funkce na $\Gamma_n$.
% 
% Aby byla splněna Dirichletova podmínka na $\Gamma_d$ a formy $a$, $l$ měly konečnou hodnotu, 
% budeme hledat slabé řešení v prostoru 
% \[
%     V:=H^1_{\Gamma_d}(\Omega) = \{ \phi \in H^1(\Omega),\ \phi = 0\text{ na }\Gamma_d\} 
% \]
% Nyní převedeme úlohu vedení tepla na abstraktní variační úlohu:
% \[ 
%     \mbox{Najdi }u\in H^1_{\Gamma_d}(\Omega):~\forall v\in H^1_{\Gamma_d}(\Omega):~a(u,v)=l(v), 
% \]
% kde formy $a(\cdot, \cdot)$ a $l(\cdot)$ mají tvar:
% \begin{equation}\label{eq:def_a_diffusion}
%     a(u,v) := (\tn K\grad u, \grad v)_{L^2(\Omega)} + (\sigma u, v)_{L^2(\Omega)},
% \end{equation}
% \begin{equation}\label{eq:def_l_diffusion}
%     l(v) := (f + \sigma u_f,v)_{L^2(\Omega)} - ( q, v)_{L^2(\Gamma_n)}.
% \end{equation}
% Pro použití Lax-Milgramova lemmatu potřebujeme ověřit omezenost forem $a$ a $l$. To ovšem platí 
% za nějakých předpokladů na další parametry úlohy. Konkrétně dokážeme následujícíc větu.
% \begin{veta}
%     Nechť $\tn K\in L^\infty(\Omega;~\R^{d\times d})$ a $\sigma\in L^\infty(\Omega)$. 
%     Pak existuje konstanta $\beta:=\beta(\norm{\tn K}_\infty,\norm{\sigma}_\infty)$ taková, že
%     \[ 
%         \forall u,v\in H^1(\Omega):~a(u,v) \le \beta \norm{u}_{1,2}\norm{v}_{1,2}, 
%     \]
%     kde bilineární forma $a$ je definována v \eqref{eq:def_a_diffusion}.
%     Je-li navíc $f,u_f\in L^2(\Omega)$ a $q\in L^2(\Gamma_n)$, pak existuje 
%     $\gamma:=\gamma(\norm{f}_2,\norm{\sigma}_\infty,\norm{u_f}_2,\norm{q}_{2,\Gamma_n})$ takové, že
%     \[ 
%         \forall v\in H^1(\Omega):~l(v) \le \gamma\norm{v}_{1,2}, 
%     \]
%     kde lineární forma $l$ je definována v \eqref{eq:def_l_diffusion}.
% \end{veta}
% \begin{proof}
%     Nejprve odhadneme postupně všechny výrazy v $a$.
%     S využitím Cauchyovy-Schwarzovy nerovnosti a faktu, že $\norm{w_i}_2\le\norm{\vc w}_2$ dostaneme:
%     \begin{align*}    
%         &&(\tn K\nabla v,\nabla w)
%             & = \sum_{i,j=1}^d\int_\Omega k_{ij}(x)\partial_{x_j}v(x)\partial_{x_i}w(x)~dx\\
%         &(\text{$ab\le |a||b|$})\qquad&
%             &\le \sum_{i,j=1}^d\int_\Omega |k_{ij}||\partial_{x_j}v||\partial_{x_i}w|~dx\\
%         &(\text{předpoklad o $\tn K$)})\qquad&
%             &\le \norm{\tn K}_\infty \sum_{i,j=1}^d ( |\partial_{x_j}v|, |\partial_{x_i}w| )_{L^2(\Omega)}\\
%         &(\text{Cauchy-Schwarzova nerovnost})\qquad&
%             &\le \norm{\tn K}_\infty\left(\sum_{j=1}^d\norm{\partial_{x_j}v}_2\right)\left(\sum_{i=1}^d\norm{\partial_{x_i}w}_2\right)\\
%         &(\text{$\norm{v_i} \le \norm{\vc v}$})\qquad&
%             &\le \norm{\tn K}_\infty \big( d\norm{\nabla v}_2\big) \big( d\norm{\nabla w}_2\big)\\
%         &(\text{definice $\norm{\cdot}_{H^1(\Omega)}$})\qquad&
%             &\le d^2\norm{\tn K}_\infty\norm{v}_{H^1(\Omega)} \norm{w}_{H^1(\Omega)},
%     \end{align*}
%     
%     
%     Obdobně lze odhadnout
%     \[ 
%         (\sigma v,w)
%         \le \norm{\sigma}_\infty(|v|,|w|)
%         \le \norm{\sigma}_\infty\norm{v}_2\norm{w}_2
%         \le \norm{\sigma}_\infty\norm{v}_{1,2}\norm{w}_{1,2}. 
%     \]
%     V souhrnu jsme dokázali, že
%     \[ 
%         a(v,w) \le \left(d\norm{\tn K}_\infty+\norm{\sigma}_\infty\right)\norm{v}_{1,2}\norm{w}_{1,2} =: \beta \norm{v}_{1,2}\norm{w}_{1,2}. 
%     \]
%     Nyní odhadneme výrazy ve formě $l$:
%     \[ 
%         (f,v) \le \norm{f}_2\norm{v}_2 \le \norm{f}_2\norm{v}_{1,2}, 
%     \]
%     \[ 
%         (\sigma u_f,v) \le \norm{\sigma}_\infty\norm{u_f}_2\norm{v}_2 \le \norm{\sigma}_\infty\norm{u_f}_2\norm{v}_{1,2}, 
%     \]
%     \[ 
%         (q,v)_{\Gamma_n} \le \norm{q}_{2,\Gamma_n}\norm{v}_{2,\Gamma_n}
%         \le \norm{q}_{2,\Gamma_n}\norm{v}_{2,\partial\Omega}
%         \le C\norm{q}_{2,\Gamma_n}\norm{v}_{1,2}, 
%     \]
%     kde $C$ je konstanta z věty o stopách.
%     Platí tedy
%     \[ 
%         l(v) \le \left(\norm{f}_2+\norm{\sigma}_\infty\norm{u_f}_2+C\norm{q}_{2,\Gamma_n}\right)\norm{v}_{1,2} =:\gamma\norm{v}_{1,2}. 
%     \]
% \end{proof}
% 
% 
% \begin{veta}
% Nechť jsou splněny následující předpoklady:
% \begin{itemize}
% \item[(i)] $\tn K$ je stejnoměrně pozitivně definitní na $\Omega$, tj.
% \[ \exists \underline k>0~\forall \vc x\in\Omega~\forall\vc q\in\R^d:~\tn K(\vc x)\vc q\cdot\vc q\ge\underline k\norm{\vc q}^2; \]
% \item[(ii)] $\sigma$ je nezáporná funkce, tj.
% \[ \forall\vc x\in\Omega:~\sigma(\vc x)\ge 0. \]
% \end{itemize}
% Pak bilineární forma $a$ je eliptická na $H^1_{\Gamma_d}(\Omega)$ s konstantou $\alpha=\underline k/{C^2}$, kde $C=C(\Omega,\Gamma_d)>0$ je konstanta z \eqref{eq:friedrichs_H1gamma}.
% \end{veta}
% \begin{proof}
% \[ a(v,v) = (\tn K\nabla v,\nabla v) + (\sigma v,v)
% \ge \underline k\norm{\nabla v}_2^2 + \norm{\sqrt{\sigma}v}_2^2 \ge \underline k\norm{\nabla v}_2^2. \] 
% Díky Friedrichsově nerovnosti platí:
% \[ a(v,v) \ge \underline k\norm{\nabla v}_2^2 \ge \frac{\underline k}{C^2}\norm{v}_{1,2}^2. \]
% \end{proof}

\pagebreak
\section{Implementace Galerkinovy metody pro 1d prvky}
Chceme řešit rovnici vedení tepla na $\Omega = (0,L)$, $\Gamma_d$ je v $0$, $\Gamma_n$ je v $L$.
\begin{align}
    -\div(\tn K\grad u) &= \sigma(u_f - u) &&\text{v }\Omega,\\
    u&=0 && \text{v bodě }0,\\
    -\tn K \grad u \cdot \vc n &= q &&\text{v bodě }L.
\end{align} 
Jelikož aplikace Dirichletovy podmínky je v MKP trochu komplikovanější, aproximujeme pro začátek tuto podmínku pomocí Robinovy podmínky:
\[
    -\tn K \grad u \cdot \vc n = (u_d - u)/\epsilon\qquad \text{v bodě }0,
\]
kde $\epsilon$ je dostatečně malé kladné číslo.

Abstraktní variační úloha:
\[ 
    \mbox{Najdi }u\in H^1_{\Gamma_d}(\Omega):~\forall v\in H^1(\Omega):~a(u,v)=b(v), 
\]
kde formy $a(\cdot, \cdot)$ a $b(\cdot)$ mají tvar:
\begin{equation}\label{eq:def_a_diffusion}
    a(u,v) := ( Ku',  v')_{L^2(\Omega)} + (\sigma u, v)_{L^2(\Omega)} + u(0)v(0)/\epsilon,
\end{equation}
\begin{equation}\label{eq:def_l_diffusion}
    b(v) := (\sigma u_f,v)_{L^2(\Omega)} - qv(L).
\end{equation}

Nyní předpokládejme konečný podprostor $\tilde V \subset H^1(\Omega)$ s bází $\{v_i,\ i\in I\}$. Aplikujte na úlohu Galerkinovu metodu
a odvoďte předpis pro matici a pravou stranu. Diskrétní řešení uvažujeme ve tvaru:
\[
    \tilde u(x) = \sum_{j\in I}  u_j v_j(x)
\]
Diskrétní podobu variační úlohy dostaneme dosazením $\tilde u(x)$ a testováním $v_i(x)$:
\[
    a(\tilde u,v_i) = \sum_{j\in I} a(v_i, v_j) u_j =  b(v_i)
\]
Odtud dostaneme prvky matice a pravé strany Zde a dále uvažujeme konstantní data $K$, $\sigma$, $u_f$.
\begin{equation}
    a_{ij} = a(v_i, v_j) = K \int_0^L v'_i(x) v'_j(x) \d x+ \sigma \int_0^1 v_i(x) v_j(x) \d x + v_i(0)v_j(0)/\epsilon
\end{equation} 
\begin{equation}
    b_i = b(v_i) = \sigma u_f \int_0^L  v_i(x) \d x - qv_i(L).
\end{equation}
Pro výpočet integrálů a sestavení soustavy již potžebujeme zvolit konkrétní konečné prvky. V našem případě bude 
prostor $\tilde V$ tvořen bázovými funkcemi lineárních konečných prvků. Inteval $(0,L)$ rozdělíme pomocí bodů $x_1$,\dots, $x_{n+1}$
na $n$ podintervalů (elementů) $e_i = (x_i, x_{i+1})$. Bázové funkce jsou po částech lineární na elementech, 
funkce  $v_i$ je nenulová pouze na elementech $e_{i-1}$ a $e_{i}$. Speciálně je nutno uvažovat krajní funkce $v_1$ a $v_{n+1}$,
které jsou nenulové pouze na $e_1$, resp. $e_n$. Nyní můžeme integraci rozdělit na jednotlivé elementy. 
Postup si ukážeme pouze pro druhý integrál v první rovnici:
\[
    a_{i,j}^\sigma = \int_0^L v_i(x)v_j(x) = \int_{e_{i-1}} v_i(x)v_j(x) + \int_{e_i} v_i(x)v_j(x), \text{ pro }j= i-1, i, i+1 
\]
Dále provedeme na každém elementu $e=(y,z)$ lineární substituci $x = (z-y)t + y$, $\d x = \abs{e}\d t$, kde $\abs{e} = z-y$ je velikost elementu.
Substituce převede integrály na různých elementech na integrály přes interval $(0,1)$ 
a dostaneme bázové funkce dané pomocí jednoduchých lineárních funkcí $\phi_1(t)=t$ a $\phi_2(t)=(1-t)$:
\[
    a_{i,i}^\sigma = \abs{e_{i-1}}\int_0^1 \phi_1(t) \phi_1(t) + \abs{e_i} \int_0^1 \phi_2(t) \phi_2(t)   
\]
\[
    a_{i,i-1}^\sigma = \abs{e_{i-1}}\int_0^1 \phi_1(t) \phi_2(t)
\]
\[
    a_{i,i+1}^\sigma = \abs{e_{i-1}}\int_0^1 \phi_2(t) \phi_1(t)
\]
Pro další výpočty budeme potřebovat integrály:
\[
 \int_0^1 (1-t)^2 = \int_0^1 (t)^2 = 1/3,\quad \int_0^1 (1-t)t=1/6,\quad \int_0^1 (1-t)=\int_0^1 t=1/2
\]
Dosazením za funkce $\phi$ dostaneme:
\[
    a_{i,i}^\sigma = \abs{e_{i-1}}\int_0^1 t^2 + \abs{e_i} \int_0^1 (1-t)^2 = (\abs{e_{i-1}} + \abs{e_i})(1/3)    
\]
\[
    a_{i,i-1}^\sigma = \abs{e_{i-1}}\int_0^1 t(1-t) = \abs{e_{i-1}}(1/6)
\]
\[
    a_{i,i+1}^\sigma = \abs{e_{i-1}}\int_0^1 (1-t)t = \abs{e_{i}}(1/6)
\]
Podobně zpracujeme i další členy a dostaneme:
\[
    a_{i,i} =  (\abs{e_{i-1}} + \abs{e_i})(K + \sigma/3)    
\]
\[
    a_{i,i-1} = \abs{e_{i-1}}(-K + \sigma/6)
\]
\[
    a_{i,i+1} = \abs{e_{i}}(-K + \sigma/6)
\]
\[
    b_{i} = (\abs{e_{i-1}} + \abs{e_i})(\sigma u_f/2)
\]
Pro $i=1$ dostaneme odlišný předpisy zahrnující pouze element $e_i$ :
\[
    a_{i,i} =  \abs{e_i}(K + \sigma/3)    
\]
\[
    a_{i,i+1} = \abs{e_{i}}(-K + \sigma/6)
\]
\[
    b_{i} = \abs{e_i}(\sigma u_f/2)
\]
Podobně pro $i=n+1$ dostaneme předpisy zahrnující pouze element $e_{n-1}$ :
\[
    a_{i,i} =  \abs{e_{i-1}(K + \sigma/3)    
\]
\[
    a_{i,i-1} = \abs{e_{i-1}}(-K + \sigma/6)
\]
\[
    b_{i} = \abs{e_{i-1}}(\sigma u_f/2)
\]


s

Na jednom elementu $e=(y,z)$ použijeme substituci $x = (z-y)t+y$ čímž převedeme integraci na interval $(0,1)$:
\begin{equation}
    a_{ij} = \sum_{e\in\mathcal T} \int_0^1 \Big[ K_e \phi'_i(t) \phi'_j(t) 
    + \sigma_e \phi_i(t) \phi_j(t) \Big] \abs{e} \d t  
             + v_i(0)v_j(0)/\epsilon
\end{equation}
\begin{equation}
    b_i = \sum_{e\in\mathcal T} \int_e \sigma_e u_{fe} \phi_i(t))  \abs{e} \d t - q(L)v(L).
\end{equation}


Na "referenčním elementu" $(0,1)$ máme dvě bázové funkce $\phi_0=(1-t)$ a $\phi_1=t$ a lokální příspěvek do matice $\tn A$ a pravé strany $\vc b$ je
\[
        a_{00} =K_e \abs{e} \int_0^1 (-1)(-1) + \sigma_e \abs{e}\int_0^1 (1-t)^2
\]
\[
        a_{11} =K_e \abs{e} \int_0^1 (1)(1) + \sigma_e \abs{e}\int_0^1 (t)^2
\]
\[
        a_{01} =K_e \abs{e} \int_0^1 (1)(-1) + \sigma_e \abs{e}\int_0^1 (1-t)t
\]
\[
        b_0 = \sigma_e u_{fe} \abs{e} \int_0^1 (1-t)
\]
\[
        b_1 = \sigma_e u_{fe} \abs{e} \int_0^1 t
\]



\begin{thebibliography}{99}
\bibitem{Rektorys} K. Rektorys a spol. : 
{\it Přehled užité matematiky.} Prometheus, Praha, 1995.
\bibitem{CVUT} \verb http://euler.fd.cvut.cz/predmety/ml2/files/MA2_CV.pdf (originál),\\
   \verb http://morf.matfyz.cz/vyuka/mft/MA2_CV.pdf (kopie)
\bibitem{Veit} J. Veit: {\it Integrální transformace.} SNTL, Praha, 1979.
\bibitem{FeynmanII} R. Feynman: {\it Přednášky z fyziky II.}, Fragment, 2001
\bibitem{SedlakStoll} B. Sedlák, I. Štoll: {\it Eletřina a magnetismus.} Academia, Praha, 2002.
\end{thebibliography}

%        * MEZNÍK, I, KARÁSEK, J., MIKLÍČEK, J. Matematika I pro strojní fakulty. SNTL, Praha, 1992.
%        * [1] Brabec, J., Hrůza, B.: Matematická analýza II. Praha, SNTL, 1986.
%        * [5] Horský, J., Novotný, J., Štefaník, M.: Mechanika ve fyzice, Academia, Praha, 2001.

\end{document}








\prednaska
\section{Všehochuť}
\subsection{Laplaceova transformace, Fourierovy řady.}
\subsection{Rovnice vedení tepla, rovnice kontinuity.}
\priklady
\cite{Veit} - Laplaceova transformace\\
\cite{Rektorys} 574 - 584 - Fourierovy řady\\
\cite{CVUT} str. 249, 58 - rovnice vedení tepla; 59 - rovnice kontinuity\\


\prednaska

\section{Mechanika tekutin}
\subsection{Stavové proměnné, rovnice kontinuity, Eulerovy a Navier-Stokesovy rovnice}
\subsection{Zjednodušené modely: Bernuliho rovnice, porézní prostředí}

* [5] Horský, J., Novotný, J., Štefaník, M.: Mechanika ve fyzice, Academia, Praha, 2001.
Feynman I.

\item přednáška \hrule
\section{Elektromagnetismus}
Elektromagnetická indukce, Faradayův zákon,  Magnetické pole, Maxwellovy rovnice
Kapitoly z Feynmana: 1 (základní zákony bez formalismu), 2 a 3 - vektorový, diferenciální a integrální počet prakticky, 4 - Maxwellovy rovnice
12 - aplikace Laplaceovy rovnice, 13 a 14 - pouze vybrane, 18 finalni Maxwelovy rovnice
\cite{FeynmanII}, \cite{SedlakStoll}


\end{enumerate}

\section{Požadavky ke zkoušce}
Vypracovanáa odevzdaná (nejpozději při zkoušce) zadaná cvičení z přednášek 1-7 (viz. výše). Dále si připravit
celkem tři témata. Po jednom z okruhů \ref{x1}, \ref{x2}, \ref{x3}. Zkouška bude probíhat ústně.
\begin{enumerate}
 \item \label{x1}
 \begin{enumerate}
    \item Funkce více proměnných: limita, spojitost, parciální derivace, totální diferenciál
    \item Derivace složených funkcí. Transformace diferenciálních výrazů při změně souřadnic. Cylindrické a sférické souřadnice.
    \item Extrémy funkcí více proměnných: nevázané a vázané extrémy, extrémy na omezené oblasti, rozpoznání             minima, maxima, sedla
  \end{enumerate}
  \item \label{x2}
  \begin{enumerate}
        \item Vektorový počet: součiny, vektorové pole, operátory $\grad$, $\div$, $\rot$
        \item Lesgueova míra a integrál (základní idea), Fubiniho věta, věta o substituci
        \item Integrace podél křivky a podél plochy, integrály I. a II. druhu, "Stokesovy věty"
  \end{enumerate}
  \item \label{x3}
  \begin{enumerate}
        \item Aplikace integrálů ve fyzice: hmota, těžiště, momenty, tok pole skrze plochu, práce pole podél křivky, rovnice vedení tepla, rovnice kontinuity
        \item Laplaceova transformace. Fourierovy řady.
        \item Elektřina a magnetismus: náboj $q$ a proudová hustota $\vc J$, stavové veličiny elektro magnetického pole: $\vc E,\ \vc H, \vc D, \vc B$, parametry $\mu$, $\eps$; pohyb náboje v elektromagnetiském poli, Lorentzova síla, umět zjednodušit úplný systém Maxwell rovnic v případech elektrostatického a stacionárního proudového pole; Ohmův zákon, odpor, vodivost
   \end{enumerate}
\end{enumerate}
